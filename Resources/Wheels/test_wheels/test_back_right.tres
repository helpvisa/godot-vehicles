[gd_resource type="Resource" load_steps=4 format=3 uid="uid://bqkgqctuo2xet"]

[ext_resource type="Curve" uid="uid://dy50co58yq8db" path="res://Resources/Curves/Tires/standard_tarmac.tres" id="1_a76rd"]

[sub_resource type="CylinderMesh" id="CylinderMesh_8iqb4"]
top_radius = 0.381
bottom_radius = 0.381
height = 0.2
radial_segments = 16
rings = 2

[sub_resource type="GDScript" id="GDScript_b4dvv"]
script/source = "extends Resource

# public / settable
@export var offset: Vector3
@export var pacejkaCurve: Curve
@export var model: Mesh
@export var radius: float
@export var suspensionStrength: float
@export var suspensionDamping: float
@export var powered: bool
@export var steerable: bool
@export var brakes: bool
@export var maxDriveForce: float

# local
var target: Vector3 = Vector3.ZERO
var previousPosition: Vector3 = Vector3.ZERO
var previousVelocity: Vector3 = Vector3.ZERO
var previousForwardVelocity: Vector3 = Vector3.ZERO
var isGrounded: bool = false
var currentRPM: float = 0
var slip: float = 1
var grip: float = 1
var suspensionForce: float = 1
var appliedWeight: float = 1
var currentDrive: float = 0
var tractionTorque: float = 0
var brakingTorque: float = 0
var angularAcceleration: float = 0
var angularVelocity: float = 0
var appliedAcceleration: float = 0

func _init(\\
	p_offset = Vector3.ZERO,\\
	p_pacejkaCurve = null,\\
	p_model = null,\\
	p_radius = 0.33,\\
	p_suspensionStrength = 2400,\\
	p_suspensionDamping = 1800,\\
	p_powered = true,\\
	p_steerable = true,\\
	p_brakes = true,\\
	p_maxDriveForce = 1400 * 9.8):
		offset = p_offset
		pacejkaCurve = p_pacejkaCurve
		model = p_model
		radius = p_radius
		suspensionStrength = p_suspensionStrength
		suspensionDamping = p_suspensionDamping
		powered = p_powered
		steerable = p_steerable
		brakes = p_brakes
		maxDriveForce = p_maxDriveForce
"

[resource]
script = SubResource("GDScript_b4dvv")
offset = Vector3(0.6, -0.55, -1.2)
pacejkaCurve = ExtResource("1_a76rd")
model = SubResource("CylinderMesh_8iqb4")
radius = 0.33
suspensionStrength = 2400.0
suspensionDamping = 1800.0
powered = true
steerable = false
brakes = true
maxDriveForce = 13720.0
